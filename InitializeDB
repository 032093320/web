package dataBase;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException; 
import javax.naming.Context;
import javax.naming.InitialContext;
import javax.naming.NamingException;
import org.apache.tomcat.dbcp.dbcp.BasicDataSource;

public class InitializeDB 
{

	//private fields
	private String insertCommand;
	private String driver;
	private String url;
	private Context context;
	private BasicDataSource dataSource;
	private Connection connection;
	private PreparedStatement statement; 
	private ResultSet results;
	
	public InitializeDB() 
	{
		this.url = "java:comp/env/jdbc/UsersDatasource";
	}

	public final int openConnection() throws Exception
	{
		int result = 0;
		try
		{
			Class.forName("org.apache.derby.jdbc.ClientDriver").newInstance();
            //connect = DriverManager.getConnection("jdbc:derby://localhost/c:/temp/db/FAQ/db");
			this.context = new InitialContext();
			this.dataSource = (BasicDataSource)this.context.lookup(this.url);
			
			//open the connection
			this.connection = this.dataSource.getConnection();
		}
		catch(Exception e)
		{
			
		}
		finally
		{
			this.closeConnection();
		}
		return result;
	}
	public final int closeConnection() throws Exception
	{
		int result = 0;
		
		try
		{
			if(this.context != null) this.context.close();
			if(this.dataSource != null) this.dataSource.close();
			if(!this.connection.isClosed()) this.connection.close(); 
			
		}
		catch(Exception e)
		{
			
		}
		finally
		{
			
		}
		
		return result;
	}

	//public final int insert(String table,)
}
